name = "worm"
type = "worm_mc"

//file where the required animations are found
require_animations = "wormanim"
//initial state (at least useful for automatic object placement)
initstate = "sit"

//special for worm.d
jet_velocity = "400 1000"

suicide_damage = "30"

//sorry!
//i.e. select animations "grave0" to "grave5" for gravestones 1-6
gravestones = "grave"
gravestones_count = "6"


//collision map additions for the worms
collisions {
    //"worm": first type for PhysicWorld.setCollide()
    worm {
        //second type + action (cookie value for setCollide())
        ground = "hit"
        //collides with other worms
        worm = "hit"
    }
    jetworm {
        ground = "jethit"
    }
    grave {
        ground = "hit"
    }
}

//physical states, used by the "states" section
physics {
    worm {
        radius = "5"
        mass = "10"
        glue_force = "400"
        walking_speed = "20"
        elasticity = "0.5"
        damageable = "1.0"
        sustainable_force = "350"
        fall_damage_factor = "0.06"
    }
    jetworm {
        radius = "5"
        mass = "10"
        //xxx can't glue with jetpack yet (but it should)
        //reason: velocity vector is cut all the time
        glue_force = "0"
        elasticity = "0.5"
        velocity_constraint = "200 200"
    }
    grave {
        radius = "5"
        fixate = "0 1"
        elasticity = "0.3"
    }
    water {
        radius = "1"
        damageable = "0.0"
        explosion_influence = "0.0"
        glue_force = "0"
        medium_viscosity = "1.0"
    }
}

//all the object states
//state selects collision class, physics and animations of an object
//state transition for worms is mostly done by special code...
states {
    sit {
        //collision class the worm physical object is set to
        collide = "worm"
        //load these physic properties
        physic = "worm"

        //see comments in src/game/sprite.d
        angle2animations = "step3"
        animations = "worm_stand_"
    }
    fly {
        collide = "worm"
        physic = "worm"

        //need animation, currently use sniff animation to see the difference...
        angle2animations = "step3"
        animations = "worm_sniff_"
    }
    walk {
        collide = "worm"
        physic = "worm"
        angle2animations = "step3"
        animations = "worm_move_"
    }
    weapon {
        collide = "worm"
        physic = "worm"
        //animation is weapon specific; special code in worm.d
    }
    jetpack {
        collide = "jetworm"
        physic = "jetworm"

        angle2animations = "twosided"
        animations = "worm_jet"
    }
    drowning {
        collide = "worm"
        physic = "water"
        
        angle2animations = "simple"
        animations = "worm_drown"
    }
    death {
        collide = "grave"
        physic = "grave"
        //not allowed to leave state
        noleave = "true"

        //animation is selected by gravestone
        //see worm.d
    }
}

//play special an animation between a specific state change
state_transitions {
    //list of state transitions
    {
        //transition from state "worm" to "jetworm"
        from = "sit"
        to = "jetpack"

        //animation works the reverse way too (just from and to swaped)
        works_reverse = "true"

        //try to disable physics while playing the animation
        disable_physics = "true"

        //give an animation as usual
        angle2animations = "step3"
        animations = "worm_startjetpack_"
    }
    {
        //this is like a hack
        from = "fly"
        to = "jetpack"
        works_reverse = "true"
        disable_physics = "true"
        angle2animations = "step3"
        animations = "worm_startjetpack_"
    }
    {
        from = "sit"
        to = "weapon"
        works_reverse = "true"
        //animation is weapon specific; see worm.d
    }
    {
        from_any = "true"
        to = "drowning"
    }
    {
        from_any = "true"
        to = "death"

        angle2animations = "simple"
        animations = "worm_die"
    }
}
